{"title":"基于深度学习和卷积神经网络的快速风格迁移","slug":"fast-style-transfer","date":"2017-12-30T11:58:53.000Z","updated":"2018-03-15T12:26:17.076Z","comments":true,"path":"api/articles/fast-style-transfer.json","photos":[],"link":"","excerpt":"之前使用了谷歌深度学习的开源神器Deeplearn.js，利用这个深度学习框架，也根据Official Demo实现了前端的快速风格迁移。使用这个库在前端风格迁移的主要流程就是读取Tensorflow训练出的checkpoints作为模型输入参数，然后在依赖Canvas和WebGL接口进行计算和渲染。速度比原来2015年的论文A Neural Algorithm of Artistic Style在Github的实现快了许多，但是作为代价，训练风格模型需要更加的耗时。","covers":["/images/fast-style-transfer/btfly.jpg","/images/fast-style-transfer/texture.png","/images/fast-style-transfer/case01.png","/images/fast-style-transfer/output-city.jpg","/images/fast-style-transfer/case02.png","/images/fast-style-transfer/output-101.jpg","/images/fast-style-transfer/case03.png","/images/fast-style-transfer/output-huacun.jpg"],"content":"<p>之前使用了谷歌深度学习的开源神器<code>Deeplearn.js</code>，利用这个深度学习框架，也根据Official Demo实现了前端的快速风格迁移。</p>\n<p>使用这个库在前端风格迁移的主要流程就是读取<code>Tensorflow</code>训练出的<code>checkpoints</code>作为模型输入参数，然后在依赖<code>Canvas</code>和<code>WebGL</code>接口进行计算和渲染。速度比原来2015年的论文<a href=\"https://arxiv.org/abs/1508.06576\" target=\"_blank\" rel=\"noopener\">A Neural Algorithm of Artistic Style</a>在Github的实现快了许多，但是作为代价，训练风格模型需要更加的耗时。</p>\n<a id=\"more\"></a>\n<h2 id=\"Style-图片选择\"><a href=\"#Style-图片选择\" class=\"headerlink\" title=\"Style 图片选择\"></a>Style 图片选择</h2><p>我选择了今年暑假在兽夏祭上抢到的《世界之旅》中蝴蝶谷的插画：</p>\n<p><strong>蝴蝶谷 Monarch Butterfly Biosphere Reserve</strong></p>\n<p>插画的作者是<a href=\"http://enmah.lofter.com/\" target=\"_blank\" rel=\"noopener\"><code>薄荷犬Enma</code></a></p>\n<p><img src=\"/images/fast-style-transfer/btfly.jpg\" alt=\"btfly\"></p>\n<h2 id=\"为什么选择这张图？\"><a href=\"#为什么选择这张图？\" class=\"headerlink\" title=\"为什么选择这张图？\"></a>为什么选择这张图？</h2><p><del>我爱夏泽尔</del></p>\n<p>因为这张图细节纹理良好，如图：</p>\n<p><img src=\"/images/fast-style-transfer/texture.png\" alt=\"detail\"></p>\n<p>主要是蝴蝶的边缘纹理比较清晰，而且黄昏时的地面上也有<strong>足够多的细节</strong>。实际上，提取风格的并不会指的是夏泽尔本人，而是夏泽尔、草地、蝴蝶的一种深层次“抽象”。</p>\n<p>这是因为，在卷积神经网络后的最底层，已经看不清楚夏泽尔是夏泽尔了，剩下的是夏泽尔的一种“特征”的体现。但是实际上，夏泽尔占整幅图的比重很小，所以大多是提取到蝴蝶和草地的深层次特征。</p>\n<h2 id=\"过程\"><a href=\"#过程\" class=\"headerlink\" title=\"过程\"></a>过程</h2><p>环境：</p>\n<ul>\n<li>操作系统：Windows 10</li>\n<li>显卡： NVD GTX 1060 6GB</li>\n<li>cuDnn: 6.x</li>\n<li>cuda: 8.x</li>\n<li>Tensorflow: 1.3</li>\n</ul>\n<p>实际上大概跑了8个小时，训练集是<code>train2014</code>，每次<code>Epoch</code>迭代1000次，<code>batch size</code>为6。</p>\n<h2 id=\"结果\"><a href=\"#结果\" class=\"headerlink\" title=\"结果\"></a>结果</h2><ul>\n<li>城市</li>\n</ul>\n<p><img src=\"/images/fast-style-transfer/case01.png\" alt=\"case01\"></p>\n<p>输出：</p>\n<p><img src=\"/images/fast-style-transfer/output-city.jpg\" alt=\"city\"></p>\n<ul>\n<li>台北101</li>\n</ul>\n<p><img src=\"/images/fast-style-transfer/case02.png\" alt=\"tai101\"></p>\n<p>输出：</p>\n<p><img src=\"/images/fast-style-transfer/output-101.jpg\" alt=\"101\"></p>\n<ul>\n<li>花村 - 守望先锋</li>\n</ul>\n<p><img src=\"/images/fast-style-transfer/case03.png\" alt=\"huacun\"></p>\n<p>输出：</p>\n<p><img src=\"/images/fast-style-transfer/output-huacun.jpg\" alt=\"huacun\"></p>\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p>怎么样，很酷吧。</p>\n","categories":[],"tags":[{"name":"深度学习","slug":"深度学习","count":1,"path":"api/tags/深度学习.json"},{"name":"卷积神经网络","slug":"卷积神经网络","count":1,"path":"api/tags/卷积神经网络.json"}]}