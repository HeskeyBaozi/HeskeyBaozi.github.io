{"name":"作用域链","slug":"作用域链","count":1,"postlist":[{"title":"“动静结合” 小白初探静态(词法)作用域与执行环境(EC)","slug":"Lang-scope-and-closure","date":"2016-04-07T05:31:32.000Z","updated":"2016-04-07T05:31:32.000Z","comments":true,"path":"api/articles/Lang-scope-and-closure.json","excerpt":"<p>从图书馆翻过各种JS的书之后，对<strong>作用域/执行环境/闭包</strong>这些概念有了一个比较清晰的认识。</p>\n<h1 id=\"栗子说明一切\"><a href=\"#栗子说明一切\" class=\"headerlink\" title=\"栗子说明一切\"></a>栗子说明一切</h1><h2 id=\"第一个栗子\"><a href=\"#第一个栗子\" class=\"headerlink\" title=\"第一个栗子\"></a>第一个栗子</h2><p>来看一个来自<a href=\"http://dmitrysoshnikov.com/ecmascript/javascript-the-core/#execution-context\" target=\"_blank\" rel=\"noopener\">ECMA-262</a>的栗子：<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> x = <span class=\"number\">10</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">(<span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">foo</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">var</span> y = <span class=\"number\">20</span>;</span><br><span class=\"line\">  (<span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">bar</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> z = <span class=\"number\">30</span>;</span><br><span class=\"line\">    <span class=\"comment\">// \"x\" and \"y\" are \"free variables\"</span></span><br><span class=\"line\">    <span class=\"comment\">// and are found in the next (after</span></span><br><span class=\"line\">    <span class=\"comment\">// bar's activation object) object</span></span><br><span class=\"line\">    <span class=\"comment\">// of the bar's scope chain</span></span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(x + y + z);</span><br><span class=\"line\">  &#125;)();</span><br><span class=\"line\">&#125;)();</span><br></pre></td></tr></table></figure></p>\n<p>我们可以用下图展现上面的例子(父变量对象存储在函数的<code>Scope</code>属性内)<br><img src=\"http://ww2.sinaimg.cn/large/724c9a82jw1f2qt3du7k5j20650buaa5.jpg\" alt=\"scope-chain.png\"></p>\n<p>首先，可以很容易的理解到一个事实：在从控制台输出<code>x+y+z</code>的时候，<code>x</code>和<code>y</code>是在<code>bar()</code>函数中的作用域链中<code>bar()</code>的活动对象之下找到的。实际上，<code>foo()</code>函数和<code>bar()</code>函数在执行的时候，他们的<code>scope</code>属性就已经确定了，他们的<code>scope</code>属性<strong>确定为他们外层的变量对象(VO)的集合</strong>。从图中可知，内存结构可能是这样的：<br>","keywords":null,"cover":"http://ww2.sinaimg.cn/large/724c9a82jw1f2qt3du7k5j20650buaa5.jpg","content":null,"text":"从图书馆翻过各种JS的书之后，对作用域/执行环境/闭包这些概念有了一个比较清晰的认识。栗子说明一切第一个栗子来看一个来自ECMA-262的栗子：<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>1","link":"","raw":null,"photos":[],"categories":[{"name":"Program Language","slug":"Program-Language","count":1,"path":"api/categories/Program-Language.json"},{"name":"JavaScript","slug":"Program-Language/JavaScript","count":1,"path":"api/categories/Program-Language/JavaScript.json"}],"tags":[{"name":"前端","slug":"前端","count":2,"path":"api/tags/前端.json"},{"name":"JavaScript","slug":"JavaScript","count":1,"path":"api/tags/JavaScript.json"},{"name":"作用域链","slug":"作用域链","count":1,"path":"api/tags/作用域链.json"},{"name":"闭包","slug":"闭包","count":1,"path":"api/tags/闭包.json"}]}]}